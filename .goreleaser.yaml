version: 2

builds:
  - id: "gitstatus-binary"
    env:
      - "CGO_ENABLED=0"
    goos:
      - "darwin" # Casks are typically for macOS only
    goarch:
      - "amd64"
      - "arm64"
    ldflags:
      - "-s -w -X main.version={{.Version}} -X main.commit={{.Commit}} -X main.date={{.Date}}"

homebrew_casks:
  - name: "gitstatus"
    hooks:
      post:
        install: |
          if OS.mac?
            system_command "/usr/bin/xattr", args: ["-dr", "com.apple.quarantine", "#{staged_path}/gitstatus"]
          end
    repository:
      owner: "Jleagle"
      name: "homebrew-gitstatus"
      token: "{{ .Env.HOMEBREW_GITHUB_TOKEN }}"
      pull_request:
        enabled: false
        draft: false
